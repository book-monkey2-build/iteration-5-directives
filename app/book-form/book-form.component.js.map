{"version":3,"file":"book-form.component.js","sourceRoot":"","sources":["../../home/travis/build/Angular2Buch/TMP/BookMonkey/tmp/broccoli_type_script_compiler-input_base_path-BCvq2kNW.tmp/0/src/app/book-form/book-form.component.ts"],"names":[],"mappings":"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","sourcesContent":["import { Component, Input, OnInit } from '@angular/core';\nimport { ActivatedRoute } from '@angular/router';\nimport { FormBuilder, FormGroup, FormArray, REACTIVE_FORM_DIRECTIVES, Validators } from '@angular/forms';\nimport { validateIsbn } from '../shared/isbn.validator';\nimport { Book } from '../shared/book';\nimport { BookStoreService } from '../shared/book-store.service';\n\n@Component({\n  selector: 'book-form',\n  moduleId: module.id,\n  templateUrl: 'book-form.component.html',\n  providers: [BookStoreService],\n  directives: [REACTIVE_FORM_DIRECTIVES]\n})\nexport class BookFormComponent implements OnInit {\n  myForm: FormGroup;\n  authors: FormArray;\n  thumbnails: FormArray;\n  isUpdatingBook: boolean;\n\n  constructor(\n    private fb: FormBuilder, \n    private bs: BookStoreService,\n    private route: ActivatedRoute\n  ) { }\n\n  ngOnInit():void {\n    this.isUpdatingBook = false;\n    this.initBook();\n\n    this.route.params.subscribe(params => {\n      var isbn = params['isbn'];\n    \n      if(isbn) {\n        this.isUpdatingBook = true;\n        this.bs.getSingle(isbn)\n          .subscribe(b => this.initBook(b));\n      }\n    });\n  }\n\ninitBook(book?:Book){\n    if(!book) book = new Book('', '', [''], new Date(), '', 0, [{url:'', title: ''}], '');\n\n    this.myForm = this.fb.group({\n      title: [book.title, Validators.required],\n      subtitle: [book.subtitle],\n      isbn: [book.isbn, Validators.compose([\n        Validators.required,\n        validateIsbn\n      ])],\n      description: [book.description],\n      authors:     this.buildAuthorsArray(book.authors),\n      thumbnails:  this.buildThumbnialsArray(book.thumbnails),\n      published: [\n        book.published, \n        Validators.pattern('([1-9]|0[1-9]|(1|2)[0-9]|3[0-1])\\.([1-9]|0[1-9]|1[0-2])\\.[0-9]{4}')\n      ]\n     });\n  }\n\n  buildAuthorsArray(authors): FormArray {\n    this.authors = this.fb.array(authors, Validators.required);\n    return this.authors;\n  }\n\n  buildThumbnialsArray(thumbnails): FormArray {\n    this.thumbnails = this.fb.array(\n      thumbnails.map(\n        t => this.fb.group({\n          url: this.fb.control(t.url, Validators.required),\n          title: this.fb.control(t.title)\n        })\n      )\n    );\n    return this.thumbnails;\n  }\n\n  addAuthorControl(){\n    this.authors.push(this.fb.control(''));\n  }\n\n  addThumbnailControl(){\n    this.thumbnails.push(this.fb.group({url: [''], title: ['']}));\n  }\n\n  submitForm(formData){\n    this.isUpdatingBook \n      ? this.bs.update(formData.value)\n               .subscribe(res => res)\n      : this.bs.create(formData.value)\n               .subscribe(res => res)\n  }\n}"]}